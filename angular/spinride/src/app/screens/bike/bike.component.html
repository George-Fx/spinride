<app-header [showGoBack]="true" [showBasket]="true" />

<main
  *ngIf="bike"
  style="
    height: 100%;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
    user-select: none;
  "
>
  <!-- CAROUSEL -->
  <section style="position: relative; margin-bottom: 20px">
    <owl-carousel-o
      [options]="customOptions"
      (translated)="onSlideChange($event)"
    >
      <ng-template
        carouselSlide
        *ngFor="let item of bike?.images; let i = index"
        class="item"
      >
        <img
          [src]="item"
          style="width: calc(100% - 40px); margin: 0 auto; border-radius: 12px"
        />
      </ng-template>
    </owl-carousel-o>
    <ul
      style="
        display: flex;
        gap: 4px;
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
      "
    >
      <li
        *ngFor="let item of bike?.images; let i = index"
        [className]="i === 0 ? 'active' : ''"
        style="
          display: inline-block;
          cursor: pointer;
          background-color: var(--main-color);
          width: 6px;
          height: 6px;
          border-radius: 10px;
        "
        [ngStyle]="{
          backgroundColor:
            i === activeSlide ? 'rgb(22, 30, 47)' :  'rgba(22, 30, 47, 0.5)',
        }"
      ></li>
    </ul>
  </section>

  <!-- NAME WITH BUTTON -->
  <section
    style="
      margin-left: 20px;
      margin-right: 20px;
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
    "
  >
    <h3>{{ bike.name }}</h3>
    <button
      style="
        width: 44px;
        height: 44px;
        background-color: var(--white-color);
        border-radius: 50%;
        border: 1px solid #eeeeee;
        display: flex;
        justify-content: center;
        align-items: center;
      "
    >
      <img
        [src]="svg.bicycleHeart"
        alt="heart"
        style="width: 20px; height: 20px"
      />
    </button>
  </section>

  <!-- RATING -->
  <section style="margin-left: 20px; margin-right: 20px; margin-bottom: 5px">
    <ul
      style="
        display: flex;
        list-style: none;
        padding: 0;
        margin-bottom: 7px;
        align-items: center;
      "
    >
      <li
        *ngFor="let item of [1, 2, 3, 4, 5]"
        style="margin-right: 4px; margin-top: 3.5px"
      >
        <svg
          width="12"
          height="12"
          viewBox="0 0 12 12"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clip-path="url(#clip0_3517_673)">
            <path
              d="M6 1L7.545 4.13L11 4.635L8.5 7.07L9.09 10.51L6 8.885L2.91 10.51L3.5 7.07L1 4.635L4.455 4.13L6 1Z"
              stroke-linecap="round"
              stroke-linejoin="round"
              [ngStyle]="{
                fill: bike.rating >= item ? '#E5C44E' : 'transparent',
                stroke: bike.rating >= item ? '#E5C44E' : '#E5C44E'
              }"
            />
          </g>
          <defs>
            <clipPath id="clip0_3517_673">
              <rect width="12" height="12" fill="white" />
            </clipPath>
          </defs>
        </svg>
      </li>
      <span style="font-size: 12px; color: var(--text-color)">(23)</span>
    </ul>
  </section>

  <!-- PRICE WITH COUNTER -->
  <section style="margin-left: 20px; margin-right: 20px; margin-bottom: 30px">
    <div
      style="
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
      "
    >
      <span style="font-size: 20px; font-weight: 600"
        >${{ bike.price.replace('.', ',') }}</span
      >
      <div
        style="
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
          background-color: var(--white-color);
          border-radius: 40px;
          border: 1px solid #eeeeee;
        "
      >
        <button
          style="padding: 13px; margin-left: 3px"
          (click)="
            $event.stopPropagation();
            $event.preventDefault();
            removeFromCart(bike)
          "
        >
          <img [src]="svg.minusProduct" style="width: 13.91px" />
        </button>
        <span
          style="
            margin-bottom: 3px;
            margin-left: 5px;
            margin-right: 5px;
            color: var(--text-color);
            font-size: 14px;
            user-select: none;
          "
          >{{ qty }}</span
        >
        <button
          (click)="
            $event.stopPropagation(); $event.preventDefault(); addToCart(bike)
          "
          style="padding: 13px; margin-right: 3px; user-select: none"
        >
          <img [src]="svg.plusProduct" style="width: 13.91px" />
        </button>
      </div>
    </div>
  </section>

  <!-- COLOR -->
  <section style="margin-left: 20px; margin-right: 20px; margin-bottom: 34px">
    <h5 style="margin-bottom: 14px">Color</h5>
    <ul style="display: flex; flex-direction: row; flex-wrap: wrap; gap: 14px">
      <li
        *ngFor="let color of bike.colors"
        style="
          display: inline-block;
          width: 30px;
          height: 30px;
          border-radius: 50%;
          display: flex;
          justify-content: center;
          align-items: center;
        "
        (click)="
          $event.stopPropagation();
          $event.preventDefault();
          selectColor(color.code)
        "
        [ngStyle]="{
          backgroundColor: color.code,
        }"
      >
        <img
          *ngIf="selectedColor() === color.code"
          [src]="svg.colorSelect"
          style="width: 16px; height: 16px"
        />
      </li>
    </ul>
  </section>

  <!-- DESCRIPTION -->
  <section style="margin-left: 20px; margin-right: 20px; margin-bottom: 30px">
    <h5 style="margin-bottom: 14px">Color</h5>
    <p
      style="
        margin-bottom: 20px;
        font-size: 16px;
        color: var(--text-color);
        line-height: 1.7;
      "
    >
      {{ bike.description }}
    </p>
    <a [routerLink]="['/description', bike.id]"><img [src]="svg.readMore" /></a>
  </section>

  <!-- REVIEWS -->
  <section>
    <h3>Reviews (23)</h3>
  </section>
</main>
